You are working inside the existing Novapad Rust codebase (Windows-only). Implement spellcheck using Windows Spell Checking API (COM): ISpellCheckerFactory / ISpellChecker. Integrate with editor language, context menu, and NVDA announcements.

KEY USER REQUIREMENTS
1) Language:
   - Novapad already has a user-selected language (likely used by the app/editor).
   - Prefer reusing that language for spellcheck IF it is a BCP-47 tag (e.g., "it-IT", "en-US").
   - Implement a spellcheck language mode:
       a) FollowEditorLanguage (default)
       b) FixedLanguage(lang_tag)
   - If current editor language is not a valid BCP-47 / not supported by Windows spellcheck, fall back gracefully to system UI language or "en-US" and show status message.

2) Context menu on word:
   - When the user opens the context menu while focused on a word, the menu must indicate spelling status:
       - If correct: disabled item "Spelling: OK"
       - If incorrect: "Spelling: Misspelled" plus submenu:
            - Suggestions (list; Enter replaces the word)
            - Add to dictionary
            - Ignore once
   - The status and suggestions must be computed for the word under caret (or under mouse if that exists). Prefer using cached line results to avoid slow calls.

3) NVDA announcement:
   - When caret lands on a misspelled word, NVDA must announce:
       "Errore ortografico: <word>"
     (Italian string is fine; if Novapad is localized, route through existing i18n.)
   - Announce only once per word occurrence while the caret stays on it. Do not repeat on every arrow move inside the same word.
   - Use NVDA Controller Client already used in Novapad.

CONSTRAINTS
- Use Windows Spell Checking API only (no Hunspell).
- Use `windows` crate (preferred) or `windows-sys` if already used.
- Keep changes minimal, consistent with Novapad command/menu architecture.
- Handle UTF-16 offsets from COM and convert to UTF-8 byte offsets correctly.

DELIVERABLES / FILES
A) Spellcheck backend
   - Add module: src/spellcheck/windows_spellcheck.rs
   - Implement WindowsSpellChecker with:
       - supported_languages() -> Vec<String>
       - set_language(lang: &str)
       - check_text(text: &str) -> Vec<Misspelling> where Misspelling includes UTF-8 byte ranges
       - suggestions(word: &str) -> Vec<String>
       - add_to_dictionary(word: &str)
       - ignore_once(word: &str) or local ignore-once set if no API support

B) Spellcheck manager (editor-facing)
   - Add a small manager that:
       - resolves effective language based on FollowEditorLanguage vs FixedLanguage
       - caches results per line: (doc_id, line_index, line_text_hash, language) -> Vec<Misspelling>
       - provides quick query: is_word_misspelled(line_text, word_range) -> Option<Misspelling>

C) Editor integration
   - Hook on caret movement events (arrow keys, word navigation, click) to detect current word.
   - If current word is misspelled and not yet announced for that occurrence, call NVDA to speak:
       "Errore ortografico: {word}"
   - Maintain a dedup key:
       (doc_id, line_index, start_utf8, end_utf8, line_text_hash, language)
     Store last_announced_key; only announce when it changes.

D) Context menu integration
   - On context menu open:
       - compute current word range + word text
       - check spelling status using cached line data (populate cache if missing)
       - add menu items described above
       - suggestions list: selecting replaces the word and preserves caret

E) Offset conversion correctness
   - COM returns offsets in UTF-16 code units (StartIndex, Length).
   - Implement helper:
       utf16_offset_to_utf8_byte_offset(text: &str, utf16_units: u32) -> usize
   - Add unit tests: ASCII, accents ("cittÃ "), emoji ("ðŸ˜€").
   - Ensure surrogate pairs handled correctly.

F) COM/threading
   - Ensure CoInitializeEx is called in the thread doing COM calls.
   - If using background worker for spellcheck, initialize COM there too. Otherwise keep calls on UI thread and rely on caching.

CONFIG
- Add settings:
   spellcheck.enabled (bool, default true or false per existing conventions)
   spellcheck.language_mode ("follow" | "fixed")
   spellcheck.fixed_language (string, default "en-US")
- If editor already has language config, wire FollowEditorLanguage to that value.

OUTPUT REQUIREMENTS
- Provide a concise summary of changes and list of files modified/added.
- Include code with clear comments around COM, caching, and NVDA announce dedup.
- Ensure build passes and style is clippy-friendly.

Proceed to implement now in the repo.